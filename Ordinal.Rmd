---
title: "Assignment - Ordinal Logistic Regression"
author: "Dr Mohd Azmi P-UD 0079/19"
date: '`r format(Sys.Date(), "%d %B, %Y")`'
output: 
  html_document:
    code_folding: hide
    toc: true
    toc_float:
      collapsed: false
    number_sections: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = F)
options(qwraps2_markup = "markdown", knitr.kable.NA = '')
```

# Motivation

Delayed notification will delay public health action.

In this example, the researcher 


# Environment

## Packages

```{r}
library(pacman) # package manager, elegant way to load packages
p_load(tidyverse, haven, DT, broom, summarytools, knitr, scales, ordinal)
```

## Dataset & Data Exploration

In this data, there are 5 variables

1. id : ID for each district
2. ppka : PPKA status - presence of PPKA in the district (0 - no PPKA, 1 - PPKA present)
3. popnum : Number of population in the district - per 10,000 population
4. total : total disease notification received
5. delaynum : number of delayed notification received

```{r}
ordds <-  read_sav("classdsfin2.sav") %>% mutate_if(is.labelled, ~(as_factor(.)))
ordds
```


# Analysis & Result

## Descriptive

From 94 district, 60% of them have PPKA

```{r, results="asis"}
freq(ordds)

```



```{r, results="asis"}
descr(ordds)
```

```{r}
ggplot(ordds, aes(Disease, fill = Disease)) +
  geom_bar() + scale_y_continuous(labels = comma)
ggplot(ordds, aes(NotiDurCode, fill = NotiDurCode)) +
  geom_bar() + scale_y_continuous(labels = comma)
ggplot(ordds, aes(FacilityCodeGC, fill = FacilityCodeGC)) +
  geom_bar() + scale_y_continuous(labels = comma) + coord_flip()
ggplot(ordds, aes(DxDayReCodeMon, fill = DxDayReCodeMon)) +
  geom_bar() + scale_y_continuous(labels = comma) + coord_flip()
ggplot(subset(ordds, !is.na(CaseClassReCode)), aes(CaseClassReCode, fill = CaseClassReCode)) +
  geom_bar() + scale_y_continuous(labels = comma)
ggplot(ordds, aes(DxStatRecodeNoMissing, fill = DxStatRecodeNoMissing)) +
  geom_bar() + scale_y_continuous(labels = comma)
ggplot(subset(ordds, !is.na(ACDPCDReCode)), aes(ACDPCDReCode, fill = ACDPCDReCode)) +
  geom_bar() + scale_y_continuous(labels = comma)
ggplot(ordds, aes(StateReCode, fill = StateReCode)) +
  geom_bar() + scale_y_continuous(labels = comma) + coord_flip()
ggplot(ordds, aes(DxMonthCode, fill = DxMonthCode)) +
  geom_bar() + scale_y_continuous(labels = comma) + coord_flip()
```



## Ordinal Logistic Regression

### Univariable

```{r}
ordlr_dis <- clm(NotiDurCode ~ Disease, data=ordds)
summary(ordlr_dis)
tidy(ordlr_dis, exponentiate = T, conf.int = T)
```


2. The odd of Measles being in expected or above is `r round(exp(coef(ordlr_dis)[3]), 2)` higher  `r round(exp(confint(ordlr_dis)[1,]), 2)`  (95% CI: 1.10, 1.46, p = 0.001) than a normal BMI.

### Multivariable

### Prediction


# Discussion

- Present of PPKA reduce the rate / count of delayed notification
- Why poisson rate

# Conclusion

# Reference


# Additional Info

Session Info

```{r}
sessionInfo()
```

